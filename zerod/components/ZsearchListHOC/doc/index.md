<!-- @routePath:/HOC-doc/ZsearchListHOC-doc -->

# 列表展示：ZsearchListHOC

`ZsearchListHOC`是一个函数，传入`pageConfig`参数配置，返回一个有头有尾有查询列表的组件

`ZsearchListHOC`内置了一个`ZlistPanel`组件，可以`import {ZlistPanel} from "zerod"`引入，`ZlistPanel`的 props 同 `pageConfig.list`

<!-- @import : ./demo1.md -->

<!-- @import : ./demo2.md -->

<!-- @import : ./demo3.md -->

<!-- @import : ./demo4.md -->

## ZlistPanel 的 props

<!-- prettier-ignore-start -->
<!-- SOMETHING AUTO-GENERATED BY TOOLS - START -->

| 参数              | 说明                                                                 | 类型       | 默认值 |
| ----------------- | -------------------------------------------------------------------- | ---------- | ------ |
| searchForm | <div><p><code>searchForm.insertTo</code> 此属性可以是:一个已存在的dom元素 \| 一个已存在的dom元素的Id \| true \| false \| (tool)=>{return 一个已存在的dom元素 \| 一个已存在的dom元素的Id \| true \| false}，其用途为：将searchForm插到某个dom元素内,如为true则插到页头显示,(默认false)</p><p>其中<code>searchForm.items</code>的<code>render函数</code>的参数在这里多加tool,如：items:[{render:(form,changeFormItems,tool)=>{},key:"myKey"}]。</p><p>其中<code>searchForm.items</code>的<code>options函数</code>的参数在这里多加tool,如：items:[{options:(tool)=>options}]。</p><p><code>searchForm</code>的其他<code>函数属性</code>除了原有的参数，还多加tool，如 <code>searchForm.afterItemsRendered</code>:(form,methods,tool)=>{}</p><p><code>searchForm.tagsPlacement</code> tags的显示位置 in \| out , 默认 out </p><p><code>searchForm.customSearchRender</code> 使用自定义表单组件的渲染函数 </p><p><code>searchForm的其他属性</code>还包含： 请查看 <span class="z-history-href" data-path="/main/component-doc/ZsearchTags-doc">组件/ZsearchTags</span> 的 props </p></div> | object | -- |
| listType | 列表类型 | "table" \| "card" \| "custom" | "table" |
| cardCoverRender | listType="card" ，卡片的上部渲染函数或者是自定义图标、图片等 | ()=>any | -- |
| cardSpan | listType="card" ，栅栏占格,默认{ xxl:6,xl:8:lg:12:md:24} | number \| object | -- |
| panelHeader | 列表面板的头部内容,为null则不显示面板头部。也可以是一个对象：{left:(tool)=>span,center:(tool)=>span,right:(tool)=>span} | string \| (tool)=>span \| object | "列表" |
| tableParams | [Antd 的Table参数](https://ant.design/components/table-cn/)，除了columns、dataSource、pagination，其他都可用 | object | {rowkey:"id"} |
| paginationProps | [Antd 的Pagination参数](https://ant.design/components/pagination-cn/) | object | -- |
| tableColumns | 表格列数据，[同Antd的表格 columns](https://ant.design/components/table-cn/) ，其中render函数参数为：(text,record,index,tool)=>自定义内容。尽管属性名与"table"相关,当listType="card"时也是有效的,也是必需的。在此，还额外增加show属性，为是否默认显示此列(字段)。| array[object] | -- |
| actionColumnWidth | 表格操作列的宽度 | string \| number | "auto" |
| actionDataIndex | 操作区在列表数据中的key | string  | -- |
| actionRender | 自定义操作区的render | (text, record,index,tool,isListCard,getDiffBtn)=><br/>{return [按钮1,按钮2]}  | -- |
| listApiInterface | 获取列表数据的后台接口函数,其必须返回Promise | (query,sorter,tool) => Promise对象  | -- |
| listApiInterface | 删除按钮后台接口函数,其必须返回Promise | (data,tool) => Promise对象  | -- |
| showPagination | 是否启用分页 | boolean  | true |
| paginationType | 分页类型,paging:普通分页，infinite:无限追加 | "paging" \| "infinite"  | "paging" |
| showAddBtn | 是否显示新增按钮 | boolean \| <br/>function(tool){return false}  | true |
| addPageRender | 新增按钮打开的页面渲染函数,如果函数return false,此函数相当于按钮点击事件的回调；tool参数是列表组件的内部提供的一些工具方法 | function(tool){return ReacNode}  | -- |
| showDetailBtn | 是否显示详情按钮| boolean \|<br/> function(record,index,tool){return false}  | true |
| detailPageRender | 详情按钮打开的页面渲染函数,如果函数return false,此函数相当于按钮点击事件的回调；tool参数是列表组件的内部提供的一些工具方法| function(record,tool){return ReacNode}  | -- |
| showUpdateBtn | 是否显示修改按钮 | boolean \| <br/> function(record,index,tool){return false}  | true |
| updatePageRender | 修改按钮打开的页面渲染函数,如果函数return false,此函数相当于按钮点击事件的回调；tool参数是列表组件的内部提供的一些工具方法 | function(record,tool){return ReacNode}  | -- |
| showDeleteBtn | 是否显示删除按钮 | boolean \| function(record,index,tool){return false}  | true |
| moreBtnType | 更多操作按钮显示类型 | "rounding" \| "menu"  | "rounding" |
| moreBtnMap | 更多操作按钮的map数据 | object[]  | -- |
| onMoreBtnClick | 更多操作按钮点击事件，参数有item:当前按钮的map对象，record:当前行的数据 | function(item, record,tool){}  | -- |
| panelBeforeRender | 列表面板上面的渲染函数 | function(tool){return ReacNode;}  | -- |
| panelAfterRender | 列表面板下面的渲染函数 | function(tool){return ReacNode;}  | -- |
| moreContentRender | 分页控件下面更多内容的渲染函数 | function(tool){return ReacNode;}  | -- |
| addBtnDisabled | 是否禁用新增按钮 | boolean \| function(tool){return false}  | false |
| detailBtnDisabled | 是否禁用详情按钮 | boolean \| function(tool){return false}  | false |
| updateBtnDisabled | 是否禁用修改按钮 | boolean \| function(tool){return false}  | false |
| deleteBtnDisabled | 是否禁用删除按钮 | boolean \| function(tool){return false}  | false |
| exportSomething | 是一个获取tool的钩子，相当于组件的componentDidMount | function(tool){ myTool=tool }  | -- |
| addCustomBtnsRender | 操作列,可在内置默认的详情、修改、删除按钮之后追加自定义按钮 |(text, record,index,tool,isListCard,getDiffBtn)=><br/>{return \[getDiffBtn("primary","新按钮",(e)=>{}),<br/>getDiffBtn("primary","新按钮",(e)=>{})\]} | -- |
| customTemplateRender | 当listType==='custom'时自定义列表渲染函数 | ({ columns, listData, tool })=>ReactNode | -- |
| addBtnName | 新增按钮名称 | string | "新增" |
| detailBtnName | 详情按钮名称 | string | "详情" |
| updateBtnName | 修改按钮名称 | string | "修改" |
| deleteBtnName | 删除按钮名称 | string | "删除" |
| btnKeySorterMap | 对按钮的key进行排序 | object | {detailBtn: 1,updateBtn: 2,deleteBtn: 3,moreBtn: 4} |

<!-- SOMETHING AUTO-GENERATED BY TOOLS - END -->
<!-- prettier-ignore-end -->

## ZsearchListHOC 的 pageConfig

<!-- prettier-ignore-start -->
<!-- SOMETHING AUTO-GENERATED BY TOOLS - START -->

| 参数              | 说明                                                                 | 类型       | 默认值 |
| ----------------- | -------------------------------------------------------------------- | ---------- | ------ |
| ... | 包含<span class="z-history-href" data-path="/main/HOC-doc/ZpageWraperHOC-doc">ZpageWrapper</span> 的 props |--|--|
| list | ZlistPanel 的 props |object|--|
| searchForm | 同 ZlistPanel 的 props.searchForm ，二选一 |object|--|

<!-- SOMETHING AUTO-GENERATED BY TOOLS - END -->
<!-- prettier-ignore-end -->

## tool 参数

pageConfig.list 中的一些函数如`moreContentRender`提供了`tool`参数出来，有如下内容：

`tool`对象不但包含`ZerodMainContext`提供的东西（请 <span class="z-history-href" data-path="/main/context-doc/ZerodMainContext-doc">查看 上下文/ZerodMainContext</span>），比如 tool.showRightModal，还提供如下内容：

### tool.getPage

获取当前列表的分页相关信息的函数

### tool.getSearchQuery

获取当前查询表单中各控件的值的函数

### tool.methods

tool.methods 是一个对象，内容如下：

| 方法               | 说明                                 | 使用方式                                                        |
| ------------------ | -------------------------------------| ---------------------------------------------------------- |
| getWrapperProps    | 用于获取ZsearchListHOC()返回的那个组件的props | tool.methods.getWrapperProps()                     |
| showLoading        | 用于 显示/取消 当前页的loading的方法，必需参数show：true\|false |tool.methods.showLoading(true)     |
| getListData        | 更新列表数据的方法，会触发pageConfig.list的listApiInterface函数；可选参数有{merge:是否当前列表追加数据、否的话是覆盖原数据,query:是一个对象，是更多传入listApiInterface的参数,clearSearchForm:是否清空查询表单 | tool.methods.getListData({merge,query,clearSearchForm}) |
| removeOneData      | 移除当前列表的一条数据，必需参数rowData:一行的数据 或者 对应pageConfig.list.tableParams.rowKey的数据(默认是id)，如传入 {id:5}，则会移除列表数据中id=5的那一条 | tool.methods.removeOneData({id:5})  |
| openModal          | 打开当前列表所在位置关联的rightModal，与tool.showRightModal有区别；必需参数content:窗口的内容 | tool.methods.openModal(\<div>内容<\/div\>)  |
| closeCurrentModal  | 关闭当前的rightModal                  | tool.methods.closeCurrentModal()                          |
| currentListData    | 获取当前列表的全部数据(数组)的方法     | const listData=tool.methods.currentListData()              |
| setDataState       | 用于主动更新列表数据状态的方法，必需参数data:列表数据(数组) | tool.methods.setDataState([...tool.methods.currentListData()])  |
| onAdd              | 新增按钮的点击事件，会触发pageConfig.list.addPageRender函数 | tool.methods.onAdd()                  |
| onUpdate           | 修改按钮的点击事件，会触发pageConfig.list.updatePageRender函数 | tool.methods.onUpdate(record)      |
| onDetail           | 详情按钮的点击事件，会触发pageConfig.list.detailPageRender函数 | tool.methods.onDetail(record)      |
| onDelete           | 删除按钮的点击事件，会触发pageConfig.list.deleteApiInterface函数 | tool.methods.onDelete(text,record) |
| notice             | 是一个对象，弹出提示通告的方式，跟ZmainHOC中的noticeType有关，属性函数有success、error、info、warning，它们的参数有 content:提示内容，config:同antd的 notification 和 message 参数 | tool.methods.notice.success("操作成功" [,config]) |

### tool.\$router

tool.\$router 是一个对象，内容如下：

| 属性               | 说明                                 | 使用方式                                                        |
| ------------------ | -------------------------------------| ---------------------------------------------------------- |
| history            | 可以调用push、replace等跳转路由path得方法，[更多请查看react-router的history](https://reacttraining.com/react-router/web/api/history)     | tool.$router.history.push("/login")  |
| location           | 当前路由的相关信息,[更多请查看react-router的location](https://reacttraining.com/react-router/web/api/location)            | tool.$router.location.pathname       |